<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Form Alamat Indonesia</title>
</head>
<body>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8">
      <div class="card shadow-lg border-0 rounded-4">
        <div class="card-body p-4">
          <h4 class="mb-4 text-center fw-bold text-primary">Form Pemesanan</h4>
          <form id="pemesananxerdiove">
            <div class="mb-3">
              <label class="form-label">Pilihan Paket</label>
              <select name="paket" class="form-select" required>
                <option value="" disabled selected>-- Pilih Paket Obat --</option>
                <option>1 Botol Xerdiove Nakara</option>
                <option>2 Botol Xerdiove Nakara</option>
                <option>3 Botol Xerdiove Nakara</option>
                <option>4 Botol Xerdiove Nakara</option>
                <option>5 Botol Xerdiove Nakara</option>
                <option>6 Botol Xerdiove Nakara</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Nama</label>
              <input type="text" name="nama" class="form-control" placeholder="Masukkan nama lengkap" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Nomor WhatsApp</label>
              <input type="number" name="wa" class="form-control" placeholder="Masukkan nomor WhatsApp aktif" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Provinsi</label>
              <select id="provinsi" class="form-select" required></select>
            </div>

            <div class="mb-3">
              <label class="form-label">Kabupaten/Kota</label>
              <select id="kabupaten" class="form-select" required></select>
            </div>

            <div class="mb-3">
              <label class="form-label">Kecamatan</label>
              <select id="kecamatan" class="form-select" required></select>
            </div>

            <div class="mb-4">
              <label class="form-label">Kelurahan/Desa</label>
              <select id="kelurahan" class="form-select" required></select>
            </div>

            <div class="mb-4">
              <label class="form-label">Detail Alamat</label>
              <textarea name="detailAlamat" class="form-control" placeholder="Masukkan Jl / No.Rumah / Patokan" required></textarea>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg rounded-pill">
                Kirim
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById("pemesananxerdiove").addEventListener("submit", function(e) {
  e.preventDefault();

  const formData = {
    nama: this.nama.value,
    wa: this.wa.value,
    provinsi: this.provinsi.value,
    kabupaten: this.kabupaten.value,
    kecamatan: this.kecamatan.value,
    kelurahan: this.kelurahan.value,
    detailAlamat: this.detailAlamat.value, // field baru
    paket: this.paket.value
  };

  fetch("https://script.google.com/macros/s/AKfycbzR7hVdjncLpc_sIt8uINN6zyJNaAM46ASAeA2noRKTiwVh2qN82h7cjkEHfTNtbKjs0A/exec", {
    method: "POST",
    body: JSON.stringify(formData),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(response => {
    if (response.status === 'success') {
      alert("Pesanan segera diproses!");
      document.getElementById("pemesananxerdiove").reset();
    } else {
      alert("Gagal mengirim data pesanan.");
    }
  })
  .catch(err => alert("Error: " + err));
});
</script>
  <script>
    const provinsiSelect = document.getElementById('provinsi');
    const kabupatenSelect = document.getElementById('kabupaten');
    const kecamatanSelect = document.getElementById('kecamatan');
    const kelurahanSelect = document.getElementById('kelurahan');

    // Ambil daftar provinsi
    fetch('https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json')
      .then(res => res.json())
      .then(data => {
        data.forEach(prov => {
          const option = document.createElement('option');
          option.value = prov.id;
          option.text = prov.name;
          provinsiSelect.add(option);
        });
      });

    // Saat provinsi dipilih → ambil kabupaten
    provinsiSelect.addEventListener('change', () => {
      fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${provinsiSelect.value}.json`)
        .then(res => res.json())
        .then(data => {
          kabupatenSelect.innerHTML = '';
          kecamatanSelect.innerHTML = '';
          kelurahanSelect.innerHTML = '';
          data.forEach(kab => {
            const option = document.createElement('option');
            option.value = kab.id;
            option.text = kab.name;
            kabupatenSelect.add(option);
          });
        });
    });

    // Saat kabupaten dipilih → ambil kecamatan
    kabupatenSelect.addEventListener('change', () => {
      fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/districts/${kabupatenSelect.value}.json`)
        .then(res => res.json())
        .then(data => {
          kecamatanSelect.innerHTML = '';
          kelurahanSelect.innerHTML = '';
          data.forEach(kec => {
            const option = document.createElement('option');
            option.value = kec.id;
            option.text = kec.name;
            kecamatanSelect.add(option);
          });
        });
    });

    // Saat kecamatan dipilih → ambil kelurahan
    kecamatanSelect.addEventListener('change', () => {
      fetch(`https://www.emsifa.com/api-wilayah-indonesia/api/villages/${kecamatanSelect.value}.json`)
        .then(res => res.json())
        .then(data => {
          kelurahanSelect.innerHTML = '';
          data.forEach(kel => {
            const option = document.createElement('option');
            option.value = kel.id;
            option.text = kel.name;
            kelurahanSelect.add(option);
          });
        });
    });
  </script>
</body>
</html>
